definput party 1 a_in: int magnitude = 255;
definput party 2 b_in: int magnitude = 255;

defun do_mult( int a ):
  carry = select( a, 7, 8 );
  a = trunc( a << 1, 8 );
  if carry equals 1:
    a = a ^ 0x1b;
  end
end

defun gf_mult( int a, int b ):
  p = 0;
  loop i from 0 to 8:
    if (b & 1) equals 0:
      p = p ^ a;
    end
    b = b >> 1;
    do_mult( a );
  end
//  do_mult(a);
  return p;
end
    
out = gf_mult(a_in,b_in);
out_len = bit_width(out);

defoutput out;
defoutput out_len;
